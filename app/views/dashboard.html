<div class="d-flex" ng-controller="DashboardController">
  <div
    class="offcanvas-lg offcanvas-start bg-success text-white"
    tabindex="-1"
    id="sidebar"
    style="width: 280px"
  >
    <div class="offcanvas-header border-bottom border-secondary">
      <h5 class="offcanvas-title">پنل مدیریت</h5>
      <button
        type="button"
        class="btn-close btn-close-white d-lg-none"
        data-bs-dismiss="offcanvas"
        data-bs-target="#sidebar"
        aria-label="Close"
      ></button>
    </div>

    <div class="px-4 py-3 border-bottom border-secondary" ng-if="userData">
      <div class="d-flex align-items-center">
        <img
          ng-src="{{userData.avatar}}"
          alt="{{userData.name}}"
          class="rounded-circle me-3"
          style="width: 48px; height: 48px"
        />
        <div>
          <h6 class="mb-0">{{userData.name}}</h6>
          <small class="text-muted">{{userData.nickname}}</small>
        </div>
      </div>
    </div>

    <div class="offcanvas-body p-0">
      <div class="navbar-nav">
        <div class="nav-item w-100">
          <a href="/" class="nav-link active px-4 py-3">
            <i class="bi bi-speedometer2 ms-2"></i>
            داشبورد
          </a>
        </div>
        <div class="nav-item w-100">
          <button class="nav-link px-4 py-3" ng-click="loadUsers()">
            <i class="bi bi-people ms-2"></i>
            کاربران
          </button>
        </div>
        <div class="nav-item w-100">
          <a href="#" class="nav-link px-4 py-3" ng-click="logout()">
            <i class="bi bi-box-arrow-right ms-2"></i>
            خروج
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="flex-grow-1">
    <!-- Top Navbar -->
    <nav class="navbar navbar-expand-lg bg-white border-bottom sticky-top">
      <div class="container-fluid">
        <button
          class="btn btn-link d-lg-none"
          type="button"
          data-bs-toggle="offcanvas"
          data-bs-target="#sidebar"
        >
          <i class="bi bi-list fs-5"></i>
        </button>
      </div>
    </nav>

    <div class="container-fluid p-4 bg-body-tertiary min-vh-100">
      <div class="row">
        <div class="col-12" style="margin-bottom: 20px">
          <div class="card border-0 shadow-sm">
            <div class="card-body">
              <h5 class="card-title">{{welcomeMessage}} , {{userData.name}}</h5>
              <p class="card-text text-success">شما با موفقیت وارد شدید.</p>
            </div>
          </div>
        </div>

        <!-- Users list -->
        <div class="col-12" ng-if="showUsers">
          <div class="d-flex justify-content-between align-items-center py-3">
            <h2 class="m-4">کاربران</h2>
            <div class="d-flex gap-2">
              <button class="btn btn-primary">
                افزودن کاربر
                <i class="bi bi-plus-lg"></i>
              </button>
            </div>
          </div>

          <hr />
          <div class="card border-0 shadow-sm">
            <div class="card-body text-center p-0">
              <div class="table-responsive">
                <table class="table table-responsive table-bordered table-hover mb-0 p-8">
                  <thead class="table-light">
                    <tr>
                      <th class="border-0 py-3">نام و نام خانوادگی</th>
                      <th class="border-0 py-3">شماره موبایل</th>
                      <th class="border-0 py-3">شماره تماس</th>
                      <th class="border-0 py-3">شهر</th>
                      <th class="border-0 py-3">عملیات</th>
                    </tr>
                  </thead>
                  <tbody class="table-group-divide">
                    <tr ng-repeat="user in users">
                      <td class="py-3">{{user.name}}</td>
                      <td class="py-3">{{user.mobile}}</td>
                      <td class="py-3">{{user.phone || '-'}}</td>
                      <td class="py-3">{{user.city.name}}</td>
                      <td class="py-3 text-center">
                        <div class="dropdown">
                          <button
                            class="btn btn-light btn-sm"
                            data-bs-toggle="dropdown"
                          >
                          <i class="bi bi-pencil-square"></i>
                          </button>
                          <ul class="dropdown-menu dropdown-menu-end">
                            <li>
                              <a class="dropdown-item" href="#"
                                ><i class="bi bi-pencil me-2"></i>ویرایش</a
                              >
                            </li>
                            <li>
                              <a class="dropdown-item" href="#"
                                ><i class="bi bi-eye me-2"></i>مشاهده</a
                              >
                            </li>
                            <li><hr class="dropdown-divider" /></li>
                            <li>
                              <a class="dropdown-item text-danger" href="#"
                                ><i class="bi bi-trash me-2"></i>حذف</a
                              >
                            </li>
                          </ul>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  id="logoutModal"
  tabindex="-1"
  aria-labelledby="logoutModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="logoutModalLabel">تایید خروج</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        آیا مطمئن هستید که می‌خواهید از حساب کاربری خود خارج شوید؟
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          انصراف
        </button>
        <button type="button" class="btn btn-danger" ng-click="confirmLogout()">
          خروج
        </button>
      </div>
    </div>
  </div>
</div>
